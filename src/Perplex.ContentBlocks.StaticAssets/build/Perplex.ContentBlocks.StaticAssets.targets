<Project>

  <Target Name="Perplex_ContentBlocks_StaticAssets_Build"
          BeforeTargets="ResolveStaticWebAssetsInputs"
          Condition="'$(Configuration)' == 'Release' Or !Exists('$(MSBuildProjectDirectory)\wwwroot\App_Plugins\Perplex.ContentBlocks')">

    <Message Importance="High" Text="[Perplex.ContentBlocks.StaticAssets] pnpm install" />
    <Exec Command="pnpm install --frozen-lockfile --prefer-offline --config.confirmModulesPurge=false"
          WorkingDirectory="$(MSBuildProjectDirectory)" />

    <Message Importance="High" Text="[Perplex.ContentBlocks.StaticAssets] pnpm build" />
    <Exec Command="pnpm build"
          WorkingDirectory="$(MSBuildProjectDirectory)" />

  </Target>

</Project>
